graph(%x : Float(*, *)
      %hx : Float(*, *)
      %cx : Float(*, *)
      %w_ih : Float(*, *)
      %w_hh : Float(*, *)
      %alpha : Float(*)
      %beta_i : Float(*)
      %beta_h : Float(*)
      %bias : Float(*)) {
  %10 : Float(*, *), %11 : Float(*, *) = prim::DifferentiableGraph_0(%w_ih, %x, %w_hh, %hx, %alpha, %beta_i, %beta_h, %bias, %cx)
  return (%11, %10);
}
with prim::DifferentiableGraph_0 = graph(%1 : Float(*, *)
      %2 : Float(*, *)
      %3 : Float(*, *)
      %4 : Float(*, *)
      %5 : Float(*)
      %6 : Float(*)
      %7 : Float(*)
      %8 : Float(*)
      %9 : Float(*, *)) {
  %10 : Float(*, *) = aten::t(%1)
  %Wx.1 : Float(*, *) = aten::mm(%2, %10)
  %12 : Float(*, *) = aten::t(%3)
  %Uz.1 : Float(*, *) = aten::mm(%4, %12)
  %14 : int = prim::Constant[value=1]()
  %15 : Float(*, *), %16 : Float(*, *) = prim::FusionGroup_0[device=0](%7, %Uz.1, %6, %Wx.1, %5)
  %17 : Dynamic[] = prim::ListConstruct(%15, %8)
  %18 : Dynamic[] = aten::broadcast_tensors(%17)
  %19 : Dynamic, %20 : Dynamic = prim::ListUnpack(%18)
  %hy : Float(*, *), %22 : Float(*, *), %cy : Float(*, *), %outgate.1 : Float(*, *), %cellgate.1 : Float(*, *), %forgetgate.1 : Float(*, *), %ingate.1 : Float(*, *) = prim::FusionGroup_1[device=0](%9, %19, %20)
  return (%cy, %hy, %10, %Wx.1, %12, %Uz.1, %16, %ingate.1, %forgetgate.1, %cellgate.1, %outgate.1, %22);
}
with prim::FusionGroup_0 = graph(%1 : Float(*)
      %2 : Float(*, *)
      %3 : Float(*)
      %4 : Float(*, *)
      %5 : Float(*)) {
  %6 : Float(*, *) = aten::mul(%5, %4)
  %7 : Float(*, *) = aten::mul(%6, %2)
  %8 : Float(*, *) = aten::mul(%3, %4)
  %9 : int = prim::Constant[value=1]()
  %10 : Float(*, *) = aten::add(%7, %8, %9)
  %11 : Float(*, *) = aten::mul(%1, %2)
  %12 : int = prim::Constant[value=1]()
  %13 : Float(*, *) = aten::add(%10, %11, %12)
  return (%13, %6);
}
with prim::FusionGroup_1 = graph(%1 : Float(*, *)
      %2 : Dynamic
      %3 : Dynamic) {
  %4 : Float(*, *), %5 : Float(*, *), %6 : Float(*, *), %7 : Float(*, *) = prim::ConstantChunk[chunks=4, dim=1](%3)
  %8 : Float(*, *), %9 : Float(*, *), %10 : Float(*, *), %11 : Float(*, *) = prim::ConstantChunk[chunks=4, dim=1](%2)
  %12 : int = prim::Constant[value=1]()
  %13 : Float(*, *) = aten::add(%8, %4, %12)
  %14 : int = prim::Constant[value=1]()
  %15 : Float(*, *) = aten::add(%9, %5, %14)
  %16 : int = prim::Constant[value=1]()
  %17 : Float(*, *) = aten::add(%10, %6, %16)
  %18 : int = prim::Constant[value=1]()
  %19 : Float(*, *) = aten::add(%11, %7, %18)
  %ingate.1 : Float(*, *) = aten::sigmoid(%13)
  %forgetgate.1 : Float(*, *) = aten::sigmoid(%15)
  %cellgate.1 : Float(*, *) = aten::tanh(%17)
  %outgate.1 : Float(*, *) = aten::sigmoid(%19)
  %24 : Float(*, *) = aten::mul(%forgetgate.1, %1)
  %25 : Float(*, *) = aten::mul(%ingate.1, %cellgate.1)
  %26 : int = prim::Constant[value=1]()
  %cy : Float(*, *) = aten::add(%24, %25, %26)
  %28 : Float(*, *) = aten::tanh(%cy)
  %hy : Float(*, *) = aten::mul(%outgate.1, %28)
  return (%hy, %28, %cy, %outgate.1, %cellgate.1, %forgetgate.1, %ingate.1);
}
